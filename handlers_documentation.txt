# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ (Handlers)

–≠—Ç–æ—Ç —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –≤ –ø—Ä–æ–µ–∫—Ç–µ, –∏—Ö —Ç—Ä–∏–≥–≥–µ—Ä—ã (–∫–Ω–æ–ø–∫–∏ –∏ –∫–æ–º–∞–Ω–¥—ã) –∏ –∏—Ö –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥.

---

## –§–∞–π–ª: main.py

### 1. –û–±—Ä–∞–±–æ—Ç—á–∏–∫: `cmd_start`
- **–¢—Ä–∏–≥–≥–µ—Ä:** –ö–æ–º–∞–Ω–¥–∞ `/start`
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –≠—Ç–æ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞. –û–Ω –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –æ–±—ä—è—Å–Ω—è–µ—Ç —Å—É—Ç—å –±–æ—Ç–∞ (–ø–æ–∏—Å–∫ —Ç–æ–∫—Å–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤) –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö, –µ—Å–ª–∏ –µ–≥–æ —Ç–∞–º –µ—â–µ –Ω–µ—Ç. –í –∫–æ–Ω—Ü–µ –æ–Ω –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–Ω–æ–ø–∫—É "–£–∑–Ω–∞—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–π".
- **–ö–Ω–æ–ø–∫–∞:** `–£–∑–Ω–∞—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–π` (callback_data: `learn_scenario`)
- **–ö–æ–¥:**
```python
@dp.message(CommandStart())
async def cmd_start(message: Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö."""
    async with AsyncSessionLocal() as db:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
        result = await db.execute(
            select(User).where(User.telegram_id == message.from_user.id)
        )
        existing_user = result.scalar_one_or_none()
        
        if not existing_user:
            # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            new_user = User(
                telegram_id=message.from_user.id,
                user_name=message.from_user.username
            )
            db.add(new_user)
            await db.commit()
            logger.info(f"–ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {message.from_user.id} ({message.from_user.username}) –¥–æ–±–∞–≤–ª–µ–Ω –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.")
        else:
            logger.info(f"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {message.from_user.id} ({message.from_user.username}) —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.")

    start_text = (
        "<b>–ê –≤—ã –∑–Ω–∞–ª–∏, —á—Ç–æ 93% –ª—é–¥–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —á—É–≤—Å—Ç–≤—É—é—Ç —Ç—è–≥—É –∫ –ø—Å–∏—Ö–æ–ª–æ–≥–∏–∏, —Ç–∞–∫ –∏ –Ω–µ —Ä–µ–∞–ª–∏–∑—É—é—Ç —ç—Ç–æ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –ø–æ–ª–Ω–æ—Å—Ç—å—é?</b>\n\n"
        "–ü—Ä–∏—á–∏–Ω–∞ ‚Äî –≤ —Ç—Ä–µ—Ö —Ç–æ–∫—Å–∏—á–Ω—ã—Ö –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö, –∫–æ—Ç–æ—Ä—ã–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –Ω–∞—à –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö:\n\n"
        "‚úÖ –∫–æ–≥–¥–∞ –º—ã —Ç–æ–ª—å–∫–æ —É–≤–ª–µ–∫–∞–µ–º—Å—è –ø—Å–∏—Ö–æ–ª–æ–≥–∏–µ–π\n"
        "‚úÖ –∫–æ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–µ–º –ø—Ä–∞–∫—Ç–∏–∫–æ–≤–∞—Ç—å\n"
        "‚úÖ –∫–æ–≥–¥–∞ –∞–∫—Ç–∏–≤–Ω–æ —Ä–∞–±–æ—Ç–∞–µ–º —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏\n\n"
        "üé≠ –≠—Ç–∏ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ–∑–∞–º–µ—Ç–Ω–æ. –û–Ω–∏ –∑–≤—É—á–∞—Ç –∫–∞–∫:\n\n"
        '<i>"–ú–Ω–µ –µ—â—ë —É—á–∏—Ç—å—Å—è –∏ —É—á–∏—Ç—å—Å—è"</i>\n'
        '<i>"–Ø –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ–ø—ã—Ç–µ–Ω –¥–ª—è —ç—Ç–æ–≥–æ"</i>\n'
        '<i>"–°–µ–π—á–∞—Å –Ω–µ —Ç–æ –≤—Ä–µ–º—è, –≤–æ—Ç –∫–æ–≥–¥–∞..."</i>\n'
        '<i>"–£ –º–µ–Ω—è –Ω–µ—Ç —Å–∏–ª/—ç–Ω–µ—Ä–≥–∏–∏/—Ä–µ—Å—É—Ä—Å–∞"</i>\n\n"
        "–ó–≤—É—á–∏—Ç –∫–∞–∫ –∑–¥—Ä–∞–≤—ã–π —Å–º—ã—Å–ª, –Ω–æ —ç—Ç–æ –ª–æ–≤—É—à–∫–∞ ‚Äî –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –ø—Ä–æ–≥—Ä–∞–º–º–∞, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ—Ç –≤–∞—à—É —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —Å–Ω–æ–≤–∞ –∏ —Å–Ω–æ–≤–∞.\n\n"
        "<b>–•–æ—Ç–∏—Ç–µ —É–∑–Ω–∞—Ç—å, –∫–∞–∫–æ–π –∏–º–µ–Ω–Ω–æ —Å—Ü–µ–Ω–∞—Ä–∏–π —Å–µ–π—á–∞—Å —Å–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∞—à —Ä–æ—Å—Ç, –≤–∞—à—É —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –∏ –≤–∞—à –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏?</b>\n\n"
        '<i>–ê –µ—â—ë - –ø–æ–ª—É—á–∏—Ç—å —á–µ–∫-–ª–∏—Å—Ç "–ü–æ—à–∞–≥–æ–≤–∞—è —Å—Ö–µ–º–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ü–µ–ª–∏", –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–∂–µ—Ç —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å —ç—Ç–æ—Ç —Å—Ü–µ–Ω–∞—Ä–∏–π?</i>'
    )
    
    keyboard = InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="–£–∑–Ω–∞—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–π", callback_data="learn_scenario")]
    ])
    
    await message.answer(start_text, parse_mode="HTML", reply_markup=keyboard)
    logger.info(f"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {message.from_user.id} –∑–∞–ø—É—Å—Ç–∏–ª –±–æ—Ç–∞")
```

### 2. –û–±—Ä–∞–±–æ—Ç—á–∏–∫: `cmd_delete_user`
- **–¢—Ä–∏–≥–≥–µ—Ä:** –ö–æ–º–∞–Ω–¥–∞ `/del`
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –Ω–∏–º –¥–∞–Ω–Ω—ã–µ (—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–≤–∏–∑–æ–≤ –∏ —Ç.–¥.) –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.
- **–ö–Ω–æ–ø–∫–∞:** –ù–µ—Ç
- **–ö–æ–¥:**
```python
@dp.message(Command("del"))
async def cmd_delete_user(message: Message):
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /del - –∫–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –≤—Å–µ—Ö –µ–≥–æ –¥–∞–Ω–Ω—ã—Ö.
    """
    async with AsyncSessionLocal() as db:
        result = await db.execute(
            select(User).where(User.telegram_id == message.from_user.id)
        )
        user = result.scalar_one_or_none()

        if not user:
            await message.answer(
                "–í—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –ù–µ—á–µ–≥–æ —É–¥–∞–ª—è—Ç—å.",
                parse_mode="HTML"
            )
            logger.info(
                "–ö–æ–º–∞–Ω–¥–∞ /del –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {}, –Ω–æ –æ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –ë–î",
                message.from_user.id
            )
            return

        # –£–¥–∞–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∫–∞—Å–∫–∞–¥–Ω–æ —É–¥–∞–ª—è—Ç—Å—è –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏)
        await db.delete(user)
        await db.commit()

        logger.info(
            "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {} ({}) –∏ –≤—Å–µ –µ–≥–æ –¥–∞–Ω–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã –∏–∑ –ë–î",
            message.from_user.id,
            message.from_user.username
        )

        await message.answer(
            "‚úÖ –í—Å–µ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω—ã –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.\n\n"
            "–ß—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ, –Ω–∞–∂–º–∏—Ç–µ /start",
            parse_mode="HTML"
        )
```

---

## –§–∞–π–ª: handlers/scenario_handler.py

### 1. –û–±—Ä–∞–±–æ—Ç—á–∏–∫: `start_scenario`
- **–¢—Ä–∏–≥–≥–µ—Ä:** –ö–Ω–æ–ø–∫–∞ `–£–∑–Ω–∞—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–π` (callback_data: `learn_scenario`)
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–ø—É—Å–∫–∞–µ—Ç —Ü–µ–ø–æ—á–∫—É –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ (–∏–º—è, —Ç–µ–ª–µ—Ñ–æ–Ω, —Ü–µ–ª—å). –ù–∞—á–∏–Ω–∞–µ—Ç —Å –≤–æ–ø—Ä–æ—Å–∞ –æ–± –∏–º–µ–Ω–∏.
- **–ö–æ–¥:**
```python
@router.callback_query(F.data == "learn_scenario")
async def start_scenario(callback: CallbackQuery, state: FSMContext):
    await callback.message.answer("–ö–∞–∫ –í–∞—Å –∑–æ–≤—É—Ç?")
    await state.set_state(ScenarioStates.waiting_for_name)
    await callback.answer()
```

### 2. –û–±—Ä–∞–±–æ—Ç—á–∏–∫: `name_received`
- **–¢—Ä–∏–≥–≥–µ—Ä:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∏–º–µ–Ω–µ–º (—Å–æ—Å—Ç–æ—è–Ω–∏–µ `waiting_for_name`).
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª—É—á–∞–µ—Ç –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ.
- **–ö–Ω–æ–ø–∫–∏:** `‚úÖ –í–µ—Ä–Ω–æ` (`name_confirm_correct`), `‚ùå –ù–µ–≤–µ—Ä–Ω–æ` (`name_confirm_incorrect`)
- **–ö–æ–¥:**
```python
@router.message(ScenarioStates.waiting_for_name)
async def name_received(message: Message, state: FSMContext):
    await state.update_data(user_name=message.text)
    
    keyboard = InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="‚úÖ –í–µ—Ä–Ω–æ", callback_data="name_confirm_correct")],
        [InlineKeyboardButton(text="‚ùå –ù–µ–≤–µ—Ä–Ω–æ", callback_data="name_confirm_incorrect")]
    ])
    
    await message.answer(f"–í–∞—à–µ –∏–º—è: {message.text}. –í–µ—Ä–Ω–æ?", reply_markup=keyboard)
    await state.set_state(ScenarioStates.confirming_name)
```

### 3. –û–±—Ä–∞–±–æ—Ç—á–∏–∫: `name_confirmed`
- **–¢—Ä–∏–≥–≥–µ—Ä:** –ö–Ω–æ–ø–∫–∞ `‚úÖ –í–µ—Ä–Ω–æ` (callback_data: `name_confirm_correct`) –ø–æ—Å–ª–µ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏.
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞.
- **–ö–æ–¥:**
```python
@router.callback_query(F.data == "name_confirm_correct", ScenarioStates.confirming_name)
async def name_confirmed(callback: CallbackQuery, state: FSMContext):
    user_data = await state.get_data()
    user_name = user_data.get('user_name')
    
    async with AsyncSessionLocal() as db:
        result = await db.execute(
            select(User).where(User.telegram_id == callback.from_user.id)
        )
        user_record = result.scalar_one_or_none()
        
        if user_record:
            user_record.user_name = user_name
            await db.commit()
            await callback.message.answer(f"–û—Ç–ª–∏—á–Ω–æ, {user_name}! –í–∞—à–µ –∏–º—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ.")
        else:
            await callback.message.answer("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –≤–∞—à –ø—Ä–æ—Ñ–∏–ª—å.")
            await state.clear()
            await callback.answer()
            return
            
    await callback.message.answer("–ù–∞–ø–∏—à–∏—Ç–µ –í–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞")
    await state.set_state(ScenarioStates.waiting_for_phone)
    await callback.answer()
```

### 4. –û–±—Ä–∞–±–æ—Ç—á–∏–∫: `name_incorrect`
- **–¢—Ä–∏–≥–≥–µ—Ä:** –ö–Ω–æ–ø–∫–∞ `‚ùå –ù–µ–≤–µ—Ä–Ω–æ` (callback_data: `name_confirm_incorrect`) –ø–æ—Å–ª–µ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏.
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–æ—Å–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–≤–µ—Å—Ç–∏ –∏–º—è –µ—â–µ —Ä–∞–∑.
- **–ö–æ–¥:**
```python
@router.callback_query(F.data == "name_confirm_incorrect", ScenarioStates.confirming_name)
async def name_incorrect(callback: CallbackQuery, state: FSMContext):
    await callback.message.answer("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –í–∞—à–µ –∏–º—è –µ—â–µ —Ä–∞–∑.")
    await state.set_state(ScenarioStates.waiting_for_name)
    await callback.answer()
```

### 5. –û–±—Ä–∞–±–æ—Ç—á–∏–∫: `phone_received`
- **–¢—Ä–∏–≥–≥–µ—Ä:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (—Å–æ—Å—Ç–æ—è–Ω–∏–µ `waiting_for_phone`).
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª—É—á–∞–µ—Ç –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ.
- **–ö–Ω–æ–ø–∫–∏:** `‚úÖ –í–µ—Ä–Ω–æ` (`phone_confirm_correct`), `‚ùå –ù–µ–≤–µ—Ä–Ω–æ` (`phone_confirm_incorrect`)
- **–ö–æ–¥:**
```python
@router.message(ScenarioStates.waiting_for_phone)
async def phone_received(message: Message, state: FSMContext):
    await state.update_data(phone=message.text)
    
    keyboard = InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="‚úÖ –í–µ—Ä–Ω–æ", callback_data="phone_confirm_correct")],
        [InlineKeyboardButton(text="‚ùå –ù–µ–≤–µ—Ä–Ω–æ", callback_data="phone_confirm_incorrect")]
    ])
    
    await message.answer(f"–í–∞—à –Ω–æ–º–µ—Ä: {message.text}. –í–µ—Ä–Ω–æ?", reply_markup=keyboard)
    await state.set_state(ScenarioStates.confirming_phone)
```

### 6. –û–±—Ä–∞–±–æ—Ç—á–∏–∫: `phone_confirmed`
- **–¢—Ä–∏–≥–≥–µ—Ä:** –ö–Ω–æ–ø–∫–∞ `‚úÖ –í–µ—Ä–Ω–æ` (callback_data: `phone_confirm_correct`) –ø–æ—Å–ª–µ –≤–≤–æ–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞.
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏ –∑–∞–¥–∞–µ—Ç –≤–æ–ø—Ä–æ—Å –æ —Ü–µ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∫–∞—Ä—å–µ—Ä–∞, –Ω–∞–≤—ã–∫–∏, –ª–∏—á–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ).
- **–ö–Ω–æ–ø–∫–∏:** `–ù–∞—á–∞—Ç—å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é –∫–∞—Ä—å–µ—Ä—É...` (`goal_career`), `–£–ª—É—á—à–∏—Ç—å —Å–≤–æ–∏ –Ω–∞–≤—ã–∫–∏...` (`goal_skills`), `–ò–∑—É—á–∞—Ç—å –ø—Å–∏—Ö–æ–ª–æ–≥–∏—é –¥–ª—è –ª–∏—á–Ω–æ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è...` (`goal_personal`)
- **–ö–æ–¥:**
```python
@router.callback_query(F.data == "phone_confirm_correct", ScenarioStates.confirming_phone)
async def phone_confirmed(callback: CallbackQuery, state: FSMContext):
    user_data = await state.get_data()
    phone = user_data.get('phone')
    
    async with AsyncSessionLocal() as db:
        result = await db.execute(
            select(User).where(User.telegram_id == callback.from_user.id)
        )
        user_record = result.scalar_one_or_none()
        
        if user_record:
            user_record.phone = phone
            await db.commit()
            await callback.message.answer("–°–ø–∞—Å–∏–±–æ! –í–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω.")
        else:
            await callback.message.answer("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –≤–∞—à –ø—Ä–æ—Ñ–∏–ª—å.")
            await state.clear()
            await callback.answer()
            return

    # –ó–∞–¥–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å
    question_text = "–ß—Ç–æ –¥–ª—è –≤–∞—Å –≤–∞–∂–Ω–µ–µ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å?"
    keyboard = InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="–ù–∞—á–∞—Ç—å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é –∫–∞—Ä—å–µ—Ä—É –≤ –ø—Å–∏—Ö–æ–ª–æ–≥–∏–∏ –∏ –ø–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–≤—ã–π –¥–æ—Ö–æ–¥", callback_data="goal_career")],
        [InlineKeyboardButton(text="–£–ª—É—á—à–∏—Ç—å —Å–≤–æ–∏ –Ω–∞–≤—ã–∫–∏ –∏ —Ä–∞—Å—à–∏—Ä–∏—Ç—å –∫—Ä—É–≥ –∫–ª–∏–µ–Ω—Ç–æ–≤", callback_data="goal_skills")],
        [InlineKeyboardButton(text="–ò–∑—É—á–∞—Ç—å –ø—Å–∏—Ö–æ–ª–æ–≥–∏—é –¥–ª—è –ª–∏—á–Ω–æ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è –∏ —É–≥–ª—É–±–ª–µ–Ω–∏—è –∑–Ω–∞–Ω–∏–π", callback_data="goal_personal")]
    ])
    
    await callback.message.answer(question_text, reply_markup=keyboard)
    await state.set_state(ScenarioStates.waiting_for_goal)
    await callback.answer()
```

### 7. –û–±—Ä–∞–±–æ—Ç—á–∏–∫: `phone_incorrect`
- **–¢—Ä–∏–≥–≥–µ—Ä:** –ö–Ω–æ–ø–∫–∞ `‚ùå –ù–µ–≤–µ—Ä–Ω–æ` (callback_data: `phone_confirm_incorrect`) –ø–æ—Å–ª–µ –≤–≤–æ–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞.
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–æ—Å–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–≤–µ—Å—Ç–∏ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –µ—â–µ —Ä–∞–∑.
- **–ö–æ–¥:**
```python
@router.callback_query(F.data == "phone_confirm_incorrect", ScenarioStates.confirming_phone)
async def phone_incorrect(callback: CallbackQuery, state: FSMContext):
    await callback.message.answer("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –í–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –µ—â–µ —Ä–∞–∑.")
    await state.set_state(ScenarioStates.waiting_for_phone)
    await callback.answer()
```

### 8. –û–±—Ä–∞–±–æ—Ç—á–∏–∫: `goal_selected`
- **–¢—Ä–∏–≥–≥–µ—Ä:** –ö–Ω–æ–ø–∫–∞ –≤—ã–±–æ—Ä–∞ —Ü–µ–ª–∏ (`goal_career`, `goal_skills`, `goal_personal`).
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –æ–ø—Ä–µ–¥–µ–ª—è—è –µ–≥–æ –∫–∞–∫ "–ø—Å–∏—Ö–æ–ª–æ–≥–∞" –∏–ª–∏ "–Ω–µ –ø—Å–∏—Ö–æ–ª–æ–≥–∞". –ó–∞—Ç–µ–º –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ, –ø–æ–¥–≤–æ–¥—è—â–µ–µ –∫ –∫–≤–∏–∑—É.
- **–ö–Ω–æ–ø–∫–∞:** `–£–∑–Ω–∞–π —Å–≤–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π` (`discover_scenario`)
- **–ö–æ–¥:**
```python
@router.callback_query(F.data.startswith("goal_"), ScenarioStates.waiting_for_goal)
async def goal_selected(callback: CallbackQuery, state: FSMContext):
    goal = callback.data
    
    async with AsyncSessionLocal() as db:
        result = await db.execute(
            select(User).where(User.telegram_id == callback.from_user.id)
        )
        user_record = result.scalar_one_or_none()
        
        if user_record:
            if goal in ["goal_career", "goal_skills"]:
                user_record.is_psychologist = True
                user_record.is_not_psychologist = False
            elif goal == "goal_personal":
                user_record.is_not_psychologist = True
                user_record.is_psychologist = False
            
            await db.commit()
            await callback.message.answer("–°–ø–∞—Å–∏–±–æ, –≤–∞—à –≤—ã–±–æ—Ä —Å–æ—Ö—Ä–∞–Ω–µ–Ω!")
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–ª–µ–¥—É—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            user_name = user_record.user_name or "–î—Ä—É–≥"
            next_message = (
                f"–°—É–ø–µ—Ä, {user_name}!\n\n"
                "–í—ã —É–∂–µ —Å–¥–µ–ª–∞–ª–∏ –ø–µ—Ä–≤—ã–π —à–∞–≥ –≤ —Å—Ç–æ—Ä–æ–Ω—É —Å–≤–æ–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.\n\n"
                "üí° –£ –∫–∞–∂–¥–æ–≥–æ, –∫—Ç–æ –≤—ã–±–∏—Ä–∞–µ—Ç —ç—Ç–æ—Ç –ø—É—Ç—å - –ø—É—Ç—å –ø–æ–Ω–∏–º–∞–Ω–∏—è —Å–µ–±—è, –ø–æ–º–æ—â–∏ –¥—Ä—É–≥–∏–º, "
                "–ø–æ–∏—Å–∫–∞ –±–æ–ª—å—à–µ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—é ‚Äî –µ—Å—Ç—å —Å–≤–æ–π –±–µ—Å—Å–æ–∑–Ω–∞—Ç–µ–ª—å–Ω—ã–π \"—Å—Ç–æ–ø\".\n\n"
                "<i>–î–ª—è –æ–¥–Ω–æ–≥–æ ‚Äî —ç—Ç–æ \"–≤—Å—ë –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∏–¥–µ–∞–ª—å–Ω–æ, –ø–æ–∫–∞ –Ω–µ –Ω–∞—á–Ω—É\".\n"
                "–î–ª—è –¥—Ä—É–≥–æ–≥–æ ‚Äî —Å—Ç—Ä–∞—Ö –±—ã—Ç—å \"–Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ–±—É—á–µ–Ω–Ω—ã–º\".\n"
                "–¢—Ä–µ—Ç–∏–π ‚Äî –ø—Ä–æ—Å—Ç–æ –Ω–µ —Ä–∞–∑—Ä–µ—à–∞–µ—Ç —Å–µ–±–µ –±—Ä–∞—Ç—å –¥–µ–Ω—å–≥–∏ –∑–∞ –∑–Ω–∞–Ω–∏—è.</i>\n\n"
                "–í—Å—ë —ç—Ç–æ ‚Äî —Å—Ü–µ–Ω–∞—Ä–∏–∏. –û–Ω–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ —Ñ–æ–Ω–µ, –±–ª–æ–∫–∏—Ä—É—é—Ç —Ä–æ—Å—Ç, –Ω–æ –∏—Ö –º–æ–∂–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å.\n\n"
                "üé≤ <b>–°–µ–π—á–∞—Å –º—ã –ø—Ä–æ–≤–µ–¥—ë–º –Ω–µ–±–æ–ª—å—à–æ–π —Ä–∞–∑–±–æ—Ä –∏ –ø–æ–∫–∞–∂–µ–º:\n"
                "—á—Ç–æ —Ç–æ—Ä–º–æ–∑–∏—Ç –ª–∏—á–Ω–æ –≤–∞—Å –∏ –∫–∞–∫ —ç—Ç–æ —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å.</b>"
            )
            
            keyboard = InlineKeyboardMarkup(inline_keyboard=[
                [InlineKeyboardButton(text="–£–∑–Ω–∞–π —Å–≤–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π", callback_data="discover_scenario")]
            ])
            
            await callback.message.answer(next_message, parse_mode="HTML", reply_markup=keyboard)
        else:
            await callback.message.answer("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –≤–∞—à –ø—Ä–æ—Ñ–∏–ª—å.")

    await state.clear()
    await callback.answer()
```

### 9. –û–±—Ä–∞–±–æ—Ç—á–∏–∫: `discover_scenario`
- **–¢—Ä–∏–≥–≥–µ—Ä:** –ö–Ω–æ–ø–∫–∞ `–£–∑–Ω–∞–π —Å–≤–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π` (callback_data: `discover_scenario`).
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ, –æ–±—ä—è—Å–Ω—è—é—â–µ–µ –≤–∞–∂–Ω–æ—Å—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Å—Ü–µ–Ω–∞—Ä–∏—è, –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –Ω–∞—á–∞—Ç—å –∫–≤–∏–∑.
- **–ö–Ω–æ–ø–∫–∞:** `–ù–∞—á–∞—Ç—å –∫–≤–∏–∑` (`start_quiz`)
- **–ö–æ–¥:**
```python
@router.callback_query(F.data == "discover_scenario")
async def discover_scenario(callback: CallbackQuery, state: FSMContext):
    message_text = (
        "‚ú® <b>–ü–æ—Ä–∞ –∑–∞–≥–ª—è–Ω—É—Ç—å –≥–ª—É–±–∂–µ.</b>\n\n"
        "–ù–∏ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ, –Ω–∏ –æ–ø—ã—Ç, –Ω–∏ –¥–∞–∂–µ —Ö–∞—Ä–∏–∑–º–∞ –Ω–µ –∏–≥—Ä–∞—é—Ç –∫–ª—é—á–µ–≤–æ–π —Ä–æ–ª–∏, "
        "–µ—Å–ª–∏ –≤–Ω—É—Ç—Ä–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π.\n\n"
        "–≠—Ç–æ—Ç —Å—Ü–µ–Ω–∞—Ä–∏–π –º–æ–∂–µ—Ç –∑–≤—É—á–∞—Ç—å –∫–∞–∫ –ª–æ–≥–∏—á–Ω—ã–π —Å—Ç—Ä–∞—Ö, –∫–∞–∫ \"–µ—â—ë –Ω–µ –≤—Ä–µ–º—è\" "
        "–∏–ª–∏ –∫–∞–∫ \"–ø–æ–∫–∞ –Ω–µ –≥–æ—Ç–æ–≤(–∞)\"\n\n"
        "–ù–æ –æ–Ω –¥–µ–ª–∞–µ—Ç –æ–¥–Ω–æ: <b>–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç.</b>\n\n"
        "üí¨ <b>–•–æ—Ç–∏—Ç–µ —É–∑–Ω–∞—Ç—å, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –≤–∞—Å –¥–µ—Ä–∂–∏—Ç, –º–µ—à–∞–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å—Å—è –ø–æ-–Ω–∞—Å—Ç–æ—è—â–µ–º—É ‚Äî "
        "—Ö–æ—Ç—å –≤—ã —É–∂–µ –≤ —Ç–µ–º–µ –ø—Å–∏—Ö–æ–ª–æ–≥–∏–∏, —Ö–æ—Ç—å —Ç–æ–ª—å–∫–æ –Ω–∞—á–∏–Ω–∞–µ—Ç–µ –ø—É—Ç—å?</b>"
    )
    
    keyboard = InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="–ù–∞—á–∞—Ç—å –∫–≤–∏–∑", callback_data="start_quiz")]
    ])
    
    await callback.message.answer(message_text, parse_mode="HTML", reply_markup=keyboard)
    await callback.answer()
```

---

## –§–∞–π–ª: handlers/quiz_handler.py

### 1. –û–±—Ä–∞–±–æ—Ç—á–∏–∫: `start_quiz`
- **–¢—Ä–∏–≥–≥–µ—Ä:** –ö–Ω–æ–ø–∫–∞ `–ù–∞—á–∞—Ç—å –∫–≤–∏–∑` (callback_data: `start_quiz`)
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–ø—É—Å–∫–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –∫–≤–∏–∑ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ü–µ–Ω–∞—Ä–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –°–æ–∑–¥–∞–µ—Ç –∑–∞–ø–∏—Å—å –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –∫–≤–∏–∑–∞ –≤ –ë–î –∏ –∑–∞–¥–∞–µ—Ç –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å.
- **–ö–æ–¥:**
```python
@quiz_router.callback_query(F.data == "start_quiz")
async def start_quiz(callback: CallbackQuery, state: FSMContext):
    async with AsyncSessionLocal() as db:
        # ... (–∫–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏ QuizResult)
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å
    question_text = "<b>–ö–æ–≥–¥–∞ –≤—ã –¥—É–º–∞–µ—Ç–µ –æ —Ç–æ–º, —á—Ç–æ–±—ã –¥–≤–∏–≥–∞—Ç—å—Å—è –≥–ª—É–±–∂–µ –≤ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—é‚Ä¶</b>"
    
    keyboard = InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(
            text="¬´–ê –≤–¥—Ä—É–≥ —è —Å–¥–µ–ª–∞—é —á—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫ –∏ –Ω–∞–≤—Ä–µ–∂—É?¬ª",
            callback_data="q1_impostor"
        )],
        # ... (–¥—Ä—É–≥–∏–µ –∫–Ω–æ–ø–∫–∏)
    ])
    
    await callback.message.answer(question_text, parse_mode="HTML", reply_markup=keyboard)
    await state.set_state(QuizStates.question_1)
    await callback.answer()
```

### 2. –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏: `question_1_answered`, `question_2_answered`, `question_3_answered`
- **–¢—Ä–∏–≥–≥–µ—Ä:** –ö–Ω–æ–ø–∫–∏ —Å –æ—Ç–≤–µ—Ç–∞–º–∏ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –∫–≤–∏–∑–∞ (callback_data: `q1_*`, `q2_*`, `q3_*`).
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –≠—Ç–∏ —Ç—Ä–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –æ—Ç–≤–µ—Ç—ã –Ω–∞ —Ç—Ä–∏ –≤–æ–ø—Ä–æ—Å–∞ –∫–≤–∏–∑–∞. –ö–∞–∂–¥—ã–π –∏–∑ –Ω–∏—Ö –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –±–∞–ª–ª –∑–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π (`impostor`, `seeker`, `eternal_student`) –∏ –∑–∞–¥–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å. –ü–æ—Å–ª–µ —Ç—Ä–µ—Ç—å–µ–≥–æ –æ—Ç–≤–µ—Ç–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∫–Ω–æ–ø–∫–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.
- **–ö–Ω–æ–ø–∫–∞ (–ø–æ—Å–ª–µ 3-–≥–æ –≤–æ–ø—Ä–æ—Å–∞):** `–£–∑–Ω–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤` (`show_quiz_results`)
- **–ö–æ–¥ (–ø—Ä–∏–º–µ—Ä –¥–ª—è 1-–≥–æ –≤–æ–ø—Ä–æ—Å–∞):**
```python
@quiz_router.callback_query(F.data.startswith("q1_"), QuizStates.question_1)
async def question_1_answered(callback: CallbackQuery, state: FSMContext):
    answer = callback.data.replace("q1_", "")
    # ... (–∫–æ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—á–µ—Ç—á–∏–∫–æ–≤ –≤ –ë–î)
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤—Ç–æ—Ä–æ–π –≤–æ–ø—Ä–æ—Å
    question_text = "<b>–ï—Å–ª–∏ –±–ª–∏–∑–∫–∏–π —á–µ–ª–æ–≤–µ–∫ –∫—Ä–∏—Ç–∏–∫—É–µ—Ç –≤–∞—Å, –≤–∞—à–∞ —Ä–µ–∞–∫—Ü–∏—è:</b>"
    # ... (—Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –¥–ª—è 2-–≥–æ –≤–æ–ø—Ä–æ—Å–∞)
    
    await callback.message.answer(question_text, parse_mode="HTML", reply_markup=keyboard)
    await state.set_state(QuizStates.question_2)
    await callback.answer()
```

### 3. –û–±—Ä–∞–±–æ—Ç—á–∏–∫: `show_quiz_results`
- **–¢—Ä–∏–≥–≥–µ—Ä:** –ö–Ω–æ–ø–∫–∞ `–£–∑–Ω–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤` (callback_data: `show_quiz_results`).
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –¥–æ–º–∏–Ω–∏—Ä—É—é—â–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–±—Ä–∞–Ω–Ω—ã—Ö –±–∞–ª–ª–æ–≤, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –µ–≥–æ –≤ –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–≤–∏–∑–∞. –ó–∞—Ç–µ–º –≤—ã–≤–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —ç—Ç–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è.
- **–ö–Ω–æ–ø–∫–∞:** `–•–æ—á—É —É–∑–Ω–∞—Ç—å —Ü–µ–Ω—É —Å–≤–æ–µ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è` (`learn_scenario_cost`)
- **–ö–æ–¥:**
```python
@quiz_router.callback_query(F.data == "show_quiz_results")
async def show_quiz_results(callback: CallbackQuery, state: FSMContext):
    # ... (–∫–æ–¥ –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏–∑ –ë–î –∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ü–µ–Ω–∞—Ä–∏—è)
        
    # –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ü–µ–Ω–∞—Ä–∏—è
    if dominant_scenario == QuizScenario.IMPOSTOR:
        result_text = (
            "<b>–ú—ã —Ä–∞—Å—Å—á–∏—Ç–∞–ª–∏ –≤–∞—à –ø—Ä–µ–æ–±–ª–∞–¥–∞—é—â–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π.</b>\n"
            # ... (—Ç–µ–∫—Å—Ç –¥–ª—è "–°–∞–º–æ–∑–≤–∞–Ω—Ü–∞")
        )
    # ... (elif –¥–ª—è –¥—Ä—É–≥–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤)
    
    keyboard = InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(
            text="–•–æ—á—É —É–∑–Ω–∞—Ç—å —Ü–µ–Ω—É —Å–≤–æ–µ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è",
            callback_data="learn_scenario_cost"
        )]
    ])
    
    await callback.message.answer(result_text, parse_mode="HTML", reply_markup=keyboard)
    await state.clear()
    await callback.answer()
```

---

## –§–∞–π–ª: handlers/scenario_cost_handler.py

### 1. –û–±—Ä–∞–±–æ—Ç—á–∏–∫: `learn_scenario_cost`
- **–¢—Ä–∏–≥–≥–µ—Ä:** –ö–Ω–æ–ø–∫–∞ `–•–æ—á—É —É–∑–Ω–∞—Ç—å —Ü–µ–Ω—É —Å–≤–æ–µ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è` (callback_data: `learn_scenario_cost`).
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –†–∞–∑–¥–µ–ª—è–µ—Ç –ª–æ–≥–∏–∫—É –¥–ª—è "–ø—Å–∏—Ö–æ–ª–æ–≥–æ–≤" –∏ "–Ω–µ –ø—Å–∏—Ö–æ–ª–æ–≥–æ–≤". –ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø–æ—Å—á–∏—Ç–∞—Ç—å —Ü–µ–Ω—É —Å—Ü–µ–Ω–∞—Ä–∏—è –≤ –¥–µ–Ω—å–≥–∞—Ö (–¥–ª—è –ø—Å–∏—Ö–æ–ª–æ–≥–æ–≤) –∏–ª–∏ –≤ –º–µ—Å—è—Ü–∞—Ö –∂–∏–∑–Ω–∏ (–¥–ª—è –Ω–µ –ø—Å–∏—Ö–æ–ª–æ–≥–æ–≤).
- **–ö–Ω–æ–ø–∫–∏:** `–ü–æ—Å—á–∏—Ç–∞—Ç—å —Ä–µ–∞–ª—å–Ω—É—é —Ü–µ–Ω—É –º–æ–µ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è` (`calc_scenario_cost` –∏–ª–∏ `calc_scenario_cost_non_psych`)
- **–ö–æ–¥:**
```python
@scenario_cost_router.callback_query(F.data == "learn_scenario_cost")
async def learn_scenario_cost(callback: CallbackQuery):
    # ... (–∫–æ–¥ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è is_psychologist)

    if user.is_psychologist:
        # ... (—Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –ø—Å–∏—Ö–æ–ª–æ–≥–∞)
        keyboard = InlineKeyboardMarkup(
            inline_keyboard=[[InlineKeyboardButton(
                text="–ü–æ—Å—á–∏—Ç–∞—Ç—å —Ä–µ–∞–ª—å–Ω—É—é —Ü–µ–Ω—É –º–æ–µ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è",
                callback_data="calc_scenario_cost"
            )]]
        )
    else:
        # ... (—Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –Ω–µ –ø—Å–∏—Ö–æ–ª–æ–≥–∞)
        keyboard = InlineKeyboardMarkup(
            inline_keyboard=[[InlineKeyboardButton(
                text="–ü–æ—Å—á–∏—Ç–∞—Ç—å —Ä–µ–∞–ª—å–Ω—É—é —Ü–µ–Ω—É –º–æ–µ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è",
                callback_data="calc_scenario_cost_non_psych"
            )]]
        )
    
    await callback.message.answer(msg, parse_mode="HTML", reply_markup=keyboard)
    await callback.answer()
```

### 2. –û–±—Ä–∞–±–æ—Ç—á–∏–∫: `calc_scenario_cost` (–¥–ª—è –ø—Å–∏—Ö–æ–ª–æ–≥–æ–≤)
- **–¢—Ä–∏–≥–≥–µ—Ä:** –ö–Ω–æ–ø–∫–∞ `–ü–æ—Å—á–∏—Ç–∞—Ç—å —Ä–µ–∞–ª—å–Ω—É—é —Ü–µ–Ω—É –º–æ–µ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è` (callback_data: `calc_scenario_cost`).
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–ø—É—Å–∫–∞–µ—Ç –∫–≤–∏–∑ –∏–∑ —Ç—Ä–µ—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è –ø—Å–∏—Ö–æ–ª–æ–≥–æ–≤ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —É–ø—É—â–µ–Ω–Ω–æ–π –≤—ã–≥–æ–¥—ã (–∂–µ–ª–∞–µ–º—ã–π –¥–æ—Ö–æ–¥, —Ç–µ–∫—É—â–∏–π –¥–æ—Ö–æ–¥, –≤—Ä–µ–º—è –∑–∞–¥–µ—Ä–∂–∫–∏).
- **–ö–æ–¥:**
```python
@scenario_cost_router.callback_query(F.data == "calc_scenario_cost")
async def calc_scenario_cost(callback: CallbackQuery, state: FSMContext):
    # ... (–∫–æ–¥ –∑–∞–ø—É—Å–∫–∞ –∫–≤–∏–∑–∞)
```

### 3. –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏: `question_1_answered`, `question_2_answered`, `question_3_answered` (–¥–ª—è –ø—Å–∏—Ö–æ–ª–æ–≥–æ–≤)
- **–¢—Ä–∏–≥–≥–µ—Ä:** –ö–Ω–æ–ø–∫–∏ —Å –æ—Ç–≤–µ—Ç–∞–º–∏ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ (callback_data: `price_q1_*`, `price_q2_*`, `price_q3_*`).
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –æ—Ç–≤–µ—Ç—ã –Ω–∞ –∫–≤–∏–∑ –æ —Å—Ç–æ–∏–º–æ—Å—Ç–∏. –ü–æ—Å–ª–µ —Ç—Ä–µ—Ç—å–µ–≥–æ –æ—Ç–≤–µ—Ç–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—è—Ç —Ä–∞—Å—á–µ—Ç, —Å–æ—Ö—Ä–∞–Ω—è—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –ë–î –∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
- **–ö–Ω–æ–ø–∫–∞ (–≤ –∫–æ–Ω—Ü–µ):** `–ù–µ—Ç, –Ω–µ —Ö–æ—á—É` (`no_more_scenario`)
- **–ö–æ–¥ (–ø—Ä–∏–º–µ—Ä –¥–ª—è 3-–≥–æ –≤–æ–ø—Ä–æ—Å–∞):**
```python
@scenario_cost_router.callback_query(
    F.data.startswith("price_q3_"), CostQuizStates.waiting_months_delay
)
async def question_3_answered(callback: CallbackQuery, state: FSMContext):
    # ... (–∫–æ–¥ –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö –æ—Ç–≤–µ—Ç–æ–≤ –∏–∑ state)
    
    # –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é —Ä–∞—Å—á–µ—Ç–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
    cost_result = await calculate_scenario_cost(...)
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    await show_cost_results(callback, cost_result)
    await state.clear()
    await callback.answer()
```

---

## –§–∞–π–ª: handlers/non_psych_cost_handler.py

### 1. –û–±—Ä–∞–±–æ—Ç—á–∏–∫: `calc_scenario_cost_non_psych` (–¥–ª—è –Ω–µ-–ø—Å–∏—Ö–æ–ª–æ–≥–æ–≤)
- **–¢—Ä–∏–≥–≥–µ—Ä:** –ö–Ω–æ–ø–∫–∞ `–ü–æ—Å—á–∏—Ç–∞—Ç—å —Ä–µ–∞–ª—å–Ω—É—é —Ü–µ–Ω—É –º–æ–µ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è` (callback_data: `calc_scenario_cost_non_psych`).
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–ø—É—Å–∫–∞–µ—Ç –∫–≤–∏–∑ –¥–ª—è –Ω–µ-–ø—Å–∏—Ö–æ–ª–æ–≥–æ–≤ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ "—É–ø—É—â–µ–Ω–Ω–æ–≥–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–∞" (–∫–∞–∫ –¥–æ–ª–≥–æ –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç—Å—è –ø—Å–∏—Ö–æ–ª–æ–≥–∏–µ–π, –∫–∞–∫ —á–∞—Å—Ç–æ –¥—É–º–∞–µ—Ç –æ –¥–µ–π—Å—Ç–≤–∏–∏, —á—Ç–æ –º–µ—à–∞–µ—Ç).
- **–ö–æ–¥:**
```python
@non_psych_cost_router.callback_query(F.data == "calc_scenario_cost_non_psych")
async def calc_scenario_cost_non_psych(callback: CallbackQuery, state: FSMContext):
    # ... (–∫–æ–¥ –∑–∞–ø—É—Å–∫–∞ –∫–≤–∏–∑–∞)
```

### 2. –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏: `process_q1_months`, `process_q2_frequency`, `process_q3_sabotage` (–¥–ª—è –Ω–µ-–ø—Å–∏—Ö–æ–ª–æ–≥–æ–≤)
- **–¢—Ä–∏–≥–≥–µ—Ä:** –ö–Ω–æ–ø–∫–∏ —Å –æ—Ç–≤–µ—Ç–∞–º–∏ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –∫–≤–∏–∑–∞ (callback_data: `q1_*`, `q2_*`, `q3_*`).
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –æ—Ç–≤–µ—Ç—ã. –¢—Ä–µ—Ç–∏–π –≤–æ–ø—Ä–æ—Å (`process_q3_sabotage`) –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∏ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –ø–æ –∫–Ω–æ–ø–∫–µ `q3_done`. –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
- **–ö–Ω–æ–ø–∫–∞ (–≤ –∫–æ–Ω—Ü–µ):** `–•–æ—á—É –Ω–∞—á–∞—Ç—å –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å` (`no_more_scenario`)
- **–ö–æ–¥ (–¥–ª—è 3-–≥–æ –≤–æ–ø—Ä–æ—Å–∞):**
```python
@non_psych_cost_router.callback_query(
    NonPsychQuizStates.waiting_q3_sabotage,
    F.data.startswith("q3_")
)
async def process_q3_sabotage(callback: CallbackQuery, state: FSMContext):
    # ... (–ª–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤)

    if callback.data == "q3_done":
        # –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∞ ‚Äî –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –ø–æ–¥—Å—á—ë—Ç—É
        await show_non_psych_result(callback, state)
        return
    # ...
```

---

## –§–∞–π–ª: handlers/common_cta_handler.py

### 1. –û–±—Ä–∞–±–æ—Ç—á–∏–∫: `handle_no_more_scenario`
- **–¢—Ä–∏–≥–≥–µ—Ä:** –ö–Ω–æ–ø–∫–∞ `–ù–µ—Ç, –Ω–µ —Ö–æ—á—É` (`no_more_scenario`) –∏–ª–∏ `–•–æ—á—É –Ω–∞—á–∞—Ç—å –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å` (`no_more_scenario`).
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –≤–∞–∂–Ω–æ–º –≤–∏–¥–µ–æ, –∫–æ—Ç–æ—Ä–æ–µ –≤—ã–π–¥–µ—Ç –≤–µ—á–µ—Ä–æ–º.
- **–ö–Ω–æ–ø–∫–∞:** `–•–æ—á—É –ø–æ–ª—É—á–∏—Ç—å –≤–∏–¥–µ–æ` (`get_video`)
- **–ö–æ–¥:**
```python
@common_cta_router.callback_query(F.data == "no_more_scenario")
async def handle_no_more_scenario(callback: CallbackQuery):
    # ... (–∫–æ–¥ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞)
    keyboard = InlineKeyboardMarkup(
        inline_keyboard=[
            [InlineKeyboardButton(text="–•–æ—á—É –ø–æ–ª—É—á–∏—Ç—å –≤–∏–¥–µ–æ", callback_data="get_video")]
        ]
    )
    await callback.message.answer(text, parse_mode="HTML", reply_markup=keyboard)
    await callback.answer()
```

### 2. –û–±—Ä–∞–±–æ—Ç—á–∏–∫: `handle_get_video`
- **–¢—Ä–∏–≥–≥–µ—Ä:** –ö–Ω–æ–ø–∫–∞ `–•–æ—á—É –ø–æ–ª—É—á–∏—Ç—å –≤–∏–¥–µ–æ` (callback_data: `get_video`).
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ–æ–±—â–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, —á—Ç–æ –æ–Ω –ø—Ä–æ—à–µ–ª –∫–ª—é—á–µ–≤—ã–µ —à–∞–≥–∏, –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —É–∑–Ω–∞—Ç—å, –∫–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–π.
- **–ö–Ω–æ–ø–∫–∞:** `–£–∑–Ω–∞—Ç—å, –∫–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–π` (`learn_how_to_change`)
- **–ö–æ–¥:**
```python
@common_cta_router.callback_query(F.data == "get_video")
async def handle_get_video(callback: CallbackQuery):
    # ... (–∫–æ–¥)
    keyboard = InlineKeyboardMarkup(
        inline_keyboard=[
            [InlineKeyboardButton(
                text="–£–∑–Ω–∞—Ç—å, –∫–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–π",
                callback_data="learn_how_to_change"
            )]
        ]
    )
    await callback.message.answer(text, parse_mode="HTML", reply_markup=keyboard)
    await callback.answer()
```

### 3. –û–±—Ä–∞–±–æ—Ç—á–∏–∫: `handle_learn_how_to_change`
- **–¢—Ä–∏–≥–≥–µ—Ä:** –ö–Ω–æ–ø–∫–∞ `–£–∑–Ω–∞—Ç—å, –∫–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–π` (callback_data: `learn_how_to_change`).
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –î–∞–µ—Ç —Å—Å—ã–ª–∫—É –Ω–∞ –≤–∏–¥–µ–æ —Å —Ä–∞–∑–±–æ—Ä–æ–º –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É.
- **–ö–Ω–æ–ø–∫–∏:** `–°–º–æ—Ç—Ä–µ—Ç—å –≤–∏–¥–µ–æ` (URL), `–ì–æ—Ç–æ–≤(–∞) –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É` (`ready_for_next_step`)
- **–ö–æ–¥:**
```python
@common_cta_router.callback_query(F.data == "learn_how_to_change")
async def handle_learn_how_to_change(callback: CallbackQuery):
    text = "–í–æ—Ç –≤–∏–¥–µ–æ —Å —Ä–∞–∑–±–æ—Ä–æ–º, –∫–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–π."
    keyboard = InlineKeyboardMarkup(
        inline_keyboard=[
            [InlineKeyboardButton(text="–°–º–æ—Ç—Ä–µ—Ç—å –≤–∏–¥–µ–æ", url="https://ya.ru")],
            [InlineKeyboardButton(text="–ì–æ—Ç–æ–≤(–∞) –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É", callback_data="ready_for_next_step")]
        ]
    )
    await callback.message.answer(text, parse_mode="HTML", reply_markup=keyboard)
    await callback.answer()
```

---

## –§–∞–π–ª: handlers/consultation_handler.py

### 1. –û–±—Ä–∞–±–æ—Ç—á–∏–∫: `handle_ready_for_next_step`
- **–¢—Ä–∏–≥–≥–µ—Ä:** –ö–Ω–æ–ø–∫–∞ `–ì–æ—Ç–æ–≤(–∞) –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É` (callback_data: `ready_for_next_step`).
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ü–µ–Ω–∞—Ä–∏—è) –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –±–µ—Å–ø–ª–∞—Ç–Ω—É—é –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É.
- **–ö–Ω–æ–ø–∫–∞:** `–ó–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É` (`book_consultation`)
- **–ö–æ–¥:**
```python
@consultation_router.callback_query(F.data == "ready_for_next_step")
async def handle_ready_for_next_step(callback: CallbackQuery):
    # ... (–∫–æ–¥ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ü–µ–Ω–∞—Ä–∏—è)
    keyboard = InlineKeyboardMarkup(inline_keyboard=[[InlineKeyboardButton(
        text="–ó–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É",
        callback_data="book_consultation"
    )]])
    await callback.message.answer(text, parse_mode="HTML", reply_markup=keyboard)
    await callback.answer()
```

### 2. –û–±—Ä–∞–±–æ—Ç—á–∏–∫: `handle_book_consultation`
- **–¢—Ä–∏–≥–≥–µ—Ä:** –ö–Ω–æ–ø–∫–∞ `–ó–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É` (callback_data: `book_consultation`).
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –†–∞–±–æ—Ç–∞–µ—Ç —Å –≤–æ–∑—Ä–∞–∂–µ–Ω–∏–µ–º "—Å–æ–º–Ω–µ–≤–∞—é—Å—å". –ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, —á—Ç–æ–±—ã –ø—Ä–∏–Ω—è—Ç—å —Ä–µ—à–µ–Ω–∏–µ.
- **–ö–Ω–æ–ø–∫–∞:** `–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤` (`view_participant_results`)
- **–ö–æ–¥:**
```python
@consultation_router.callback_query(F.data == "book_consultation")
async def handle_book_consultation(callback: CallbackQuery):
    # ... (—Ç–µ–∫—Å—Ç –ø—Ä–æ —Å–æ–º–Ω–µ–Ω–∏—è)
    keyboard = InlineKeyboardMarkup(inline_keyboard=[[InlineKeyboardButton(
        text="–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤",
        callback_data="view_participant_results"
    )]])
    await callback.message.answer(text, parse_mode="HTML", reply_markup=keyboard)
    await callback.answer()
```

---

## –§–∞–π–ª: handlers/results_handler.py

### 1. –û–±—Ä–∞–±–æ—Ç—á–∏–∫: `handle_view_participant_results`
- **–¢—Ä–∏–≥–≥–µ—Ä:** –ö–Ω–æ–ø–∫–∞ `–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤` (callback_data: `view_participant_results`).
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –±–æ–ª—å—à—É—é –∏—Å—Ç–æ—Ä–∏—é —É—Å–ø–µ—Ö–∞ (–∫–µ–π—Å). –¢–µ–∫—Å—Ç –∫–µ–π—Å–∞ —Ä–∞–∑–Ω—ã–π –¥–ª—è –ø—Å–∏—Ö–æ–ª–æ–≥–æ–≤ –∏ –Ω–µ-–ø—Å–∏—Ö–æ–ª–æ–≥–æ–≤.
- **–ö–Ω–æ–ø–∫–∞:** `–£–∑–Ω–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ –æ –°—É–ø–µ—Ä–≤–∏–∑–∏–∏` (`learn_more_supervision`)
- **–ö–æ–¥:**
```python
@results_router.callback_query(F.data == "view_participant_results")
async def handle_view_participant_results(callback: CallbackQuery):
    # ... (–∫–æ–¥ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ç–µ–∫—Å—Ç–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç is_psychologist)
    keyboard = InlineKeyboardMarkup(inline_keyboard=[[InlineKeyboardButton(
        text="–£–∑–Ω–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ –æ –°—É–ø–µ—Ä–≤–∏–∑–∏–∏",
        callback_data="learn_more_supervision"
    )]])
    await callback.message.answer(text, parse_mode="HTML", reply_markup=keyboard)
    await callback.answer()
```

---

## –§–∞–π–ª: handlers/supervision_handler.py

### 1. –û–±—Ä–∞–±–æ—Ç—á–∏–∫: `handle_learn_more_supervision`
- **–¢—Ä–∏–≥–≥–µ—Ä:** –ö–Ω–æ–ø–∫–∞ `–£–∑–Ω–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ –æ –°—É–ø–µ—Ä–≤–∏–∑–∏–∏` (callback_data: `learn_more_supervision`).
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –î–∞–µ—Ç –±–æ–ª—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–æ–≥—Ä–∞–º–º–µ "–°—É–ø–µ—Ä–≤–∏–∑–∏—è" –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –∑–≤–æ–Ω–æ–∫ –¥–ª—è —Ä–∞–∑–±–æ—Ä–∞ —Å–∏—Ç—É–∞—Ü–∏–∏.
- **–ö–Ω–æ–ø–∫–∞:** `–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è —Ä–∞–∑–≥–æ–≤–æ—Ä–∞` / `–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–≥–æ–≤–æ—Ä` (`book_call`)
- **–ö–æ–¥:**
```python
@supervision_router.callback_query(F.data == "learn_more_supervision")
async def handle_learn_more_supervision(callback: CallbackQuery):
    # ... (–∫–æ–¥ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ç–µ–∫—Å—Ç–∞ –∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã)
    await callback.message.answer(text, parse_mode='HTML', reply_markup=keyboard)
    await callback.answer()
```

### 2. –û–±—Ä–∞–±–æ—Ç—á–∏–∫: `handle_book_call`
- **–¢—Ä–∏–≥–≥–µ—Ä:** –ö–Ω–æ–ø–∫–∞ `–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å ... —Ä–∞–∑–≥–æ–≤–æ—Ä` (callback_data: `book_call`).
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏ –∏ –ø—Ä–∏–≥–ª–∞—à–∞–µ—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–∞–Ω–∞–ª —Å –ø–æ–ª–µ–∑–Ω—ã–º–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏.
- **–ö–Ω–æ–ø–∫–∞:** `–ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞–Ω–∞–ª` (`go_to_channel`)
- **–ö–æ–¥:**
```python
@supervision_router.callback_query(F.data == 'book_call')
async def handle_book_call(callback: CallbackQuery):
    # ... (–∫–æ–¥)
    keyboard = InlineKeyboardMarkup(
        inline_keyboard=[[InlineKeyboardButton(
            text='–ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞–Ω–∞–ª',
            callback_data='go_to_channel'
        )]]
    )
    await callback.message.answer(text, parse_mode='HTML', reply_markup=keyboard)
    await callback.answer()
```

### 3. –û–±—Ä–∞–±–æ—Ç—á–∏–∫: `handle_go_to_channel`
- **–¢—Ä–∏–≥–≥–µ—Ä:** –ö–Ω–æ–ø–∫–∞ `–ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞–Ω–∞–ª` (callback_data: `go_to_channel`).
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –î–∞–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—É—é –∫–Ω–æ–ø–∫—É —Å–æ —Å—Å—ã–ª–∫–æ–π –Ω–∞ –∫–∞–Ω–∞–ª/–≥—Ä—É–ø–ø—É –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é "–ø–æ–¥–∞—Ä–æ–∫" - —Ñ–∞–π–ª `test.txt`.
- **–ö–Ω–æ–ø–∫–∞:** `–ü–µ—Ä–µ–π—Ç–∏ –≤ –≥—Ä—É–ø–ø—É` (URL)
- **–ö–æ–¥:**
```python
@supervision_router.callback_query(F.data == 'go_to_channel')
async def handle_go_to_channel(callback: CallbackQuery):
    url_keyboard = InlineKeyboardMarkup(
        inline_keyboard=[[InlineKeyboardButton(
            text='–ü–µ—Ä–µ–π—Ç–∏ –≤ –≥—Ä—É–ø–ø—É',
            url='https://ya.ru'
        )]]
    )
    await callback.message.answer(
        '–û—Ç–∫—Ä–æ–π—Ç–µ –∫–∞–Ω–∞–ª –ø–æ –∫–Ω–æ–ø–∫–µ –Ω–∏–∂–µ:', reply_markup=url_keyboard
    )
    await callback.message.answer('üéÅ –ê —Ç–µ–ø–µ—Ä—å –æ–±–µ—â–∞–Ω–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫:', parse_mode='HTML')
    # ... (–∫–æ–¥ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–∞–π–ª–∞)
    await callback.answer()
```